# 공통 필수 설정 (모든 배포에서 필요)
GCP_PROJECT_ID=your-gcp-project-id
# 기본 리전 예시: asia-northeast3 (서울)
GCP_REGION=asia-northeast3

DEPLOY_SERVICE_ACCOUNT_EMAIL=deploy-sa@your-gcp-project-id.iam.gserviceaccount.com

# Artifact Registry
ARTIFACT_REGISTRY_REPO=apps

# 이미지 빌드 전략: local_docker 또는 cloud_build
# - local_docker : 로컬 Docker 데몬으로 빌드 후 push
# - cloud_build  : Cloud Build(gcloud builds submit)를 사용
BACKEND_BUILD_MODE=local_docker

# CLI 출력/타임아웃 (긴 작업에서 '멈춘 것 같은' UX 방지)
# - CLI_STREAM_SUBPROCESS_OUTPUT=true: gcloud/docker/npm 등의 출력을 실시간으로 그대로 보여줍니다(권장)
# - false: 출력은 숨기고(캡처) 실패 시 일부만 요약합니다.
CLI_STREAM_SUBPROCESS_OUTPUT=true

# Cloud Build / 빌드 / 배포 타임아웃 (초)
# - cloud_build 모드일 때 Cloud Build 자체 timeout (gcloud builds submit --timeout=...s)
CLOUD_BUILD_TIMEOUT_SECONDS=3600
# - 로컬 CLI가 기다리는 최대 시간 (네트워크/빌드가 느린 경우 크게 잡으세요)
BACKEND_BUILD_SUBPROCESS_TIMEOUT_SECONDS=7200
# - Cloud Run deploy 대기 시간
GCLOUD_RUN_DEPLOY_TIMEOUT_SECONDS=1800

# Cloud Run 서비스 이름 (필수)
BACKEND_SERVICE_NAME=your-backend-service-name

# 소스 코드 경로
# - 백엔드(및 ETL) Docker 빌드 컨텍스트 디렉토리
BACKEND_SOURCE_DIR=.
# - 프론트엔드 빌드 디렉토리 (선택, 예: app/Frontend)
FRONTEND_SOURCE_DIR=
# - 프론트엔드 빌드 산출물 디렉토리 (firebase.json 의 public 과 일치해야 함)
FRONTEND_BUILD_DIR=dist

# 이미지 이름 (로컬 빌드시 사용되는 논리적 이름 / 태그용)
BACKEND_IMAGE_NAME=backend
FRONTEND_IMAGE_NAME=frontend

# (선택) 프론트엔드를 Cloud Run 서비스로도 배포하고 싶을 때
# - FRONTEND_SOURCE_DIR 의 Dockerfile 컨텍스트를 이미지로 빌드/푸시하여 Cloud Run 으로 배포합니다.
DEPLOY_FRONTEND_CLOUD_RUN=false
FRONTEND_SERVICE_NAME=your-frontend-service-name
# Cloud Run 프론트 공개 여부 (true 이면 --allow-unauthenticated)
FRONTEND_ALLOW_UNAUTHENTICATED=true
# Artifact Registry 리포지토리 내 프론트 이미지 패키지명(옵션, 미설정 시 frontend 사용)
FRONTEND_IMAGE_PACKAGE=frontend
#
# (선택) Firebase Hosting 의 FIREBASE_API_PREFIX 처럼, 프론트에서 /api/* 등을 백엔드로 reverse proxy 하고 싶을 때.
# Cloud Run 자체는 rewrite 기능이 없으므로, 실제 proxy 는 프론트 컨테이너(Nginx/Caddy 등)에서 처리해야 합니다.
# deploy-kit 은 컨테이너가 사용할 수 있도록 아래 env 만 주입합니다.
FRONTEND_API_PREFIX=
# 프록시 대상 URL (비우면 BACKEND_API_HOST 를 기본으로 사용합니다)
FRONTEND_API_TARGET=

# Artifact Registry 리포지토리 내 패키지명(옵션, 미설정 시 service 이름 사용)
BACKEND_IMAGE_PACKAGE=backend
ETL_IMAGE_PACKAGE=etl

# 프론트엔드 빌드 시 백엔드 API base URL 로 사용할 값
# - deploy-gcp 의 frontend 섹션에서 FRONTEND_BUILD_COMMAND 를 실행할 때
#   VITE_API_URL 환경변수로 전달됩니다.
#   예) BACKEND_API_HOST=https://your-cloud-run-backend-url
BACKEND_API_HOST=

# 프론트엔드 빌드 명령 (프로젝트별로 알맞게 설정)
# 예) FRONTEND_BUILD_COMMAND="npm run build"
FRONTEND_BUILD_COMMAND=

# 기능 토글 (리소스 생성 여부)
ENABLE_BIGQUERY=false
ENABLE_CLOUD_SQL=false
ENABLE_GCS=false
ENABLE_FIREBASE=false
ENABLE_SECRET_MANAGER=true

# 배포 토글 (해당 리소스를 실제로 배포/설정할지 여부)
DEPLOY_BACKEND=true
DEPLOY_FRONTEND=true
DEPLOY_ETL_JOB=false
CONFIGURE_SECRETS=true

# Cloud Run 공개 여부 (true 이면 --allow-unauthenticated)
BACKEND_ALLOW_UNAUTHENTICATED=true

# BigQuery (ENABLE_BIGQUERY=true 일 때만 사용)
# - 프로젝트 ID를 비우면 기본적으로 GCP_PROJECT_ID 를 사용합니다.
BIGQUERY_PROJECT_ID=
BIGQUERY_DATASET_ID=

# Cloud SQL (ENABLE_CLOUD_SQL=true 일 때만 사용, 모두 필수)
CLOUD_SQL_INSTANCE_NAME=
CLOUD_SQL_DB_NAME=
CLOUD_SQL_USER=

# GCS (ENABLE_GCS=true 일 때만 사용, 버킷 이름 필수)
GCS_BUCKET_NAME=
GCS_PREFIX=

# Firebase Hosting (ENABLE_FIREBASE=true 일 때만 사용, 둘 다 필수)
# - FIREBASE_HOSTING_SITE 는 URL 이 아니라 Hosting \"사이트 ID\" 입니다.
#   예) 사이트 URL 이 https://poly-read-aloud.web.app 인 경우
#       FIREBASE_HOSTING_SITE=poly-read-aloud
FIREBASE_PROJECT_ID=
FIREBASE_HOSTING_SITE=

# Firebase Hosting 에서 /api 등의 경로를 Cloud Run backend 로 라우팅하고 싶을 때 사용
# - 예) FIREBASE_API_PREFIX=/api  → /api/** 가 BACKEND_SERVICE_NAME (Cloud Run) 으로 전달됨
FIREBASE_API_PREFIX=

# Secret Manager prefix (선택)
# - .env.secrets 의 KEY 앞에 prefix 를 붙여 Secret 이름을 생성합니다.
SECRET_PREFIX=readaloud_


